<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BurgerCoin - Upgrades</title>
  <style>
    :root {
      --bg:#0a2a68; --panel:#121b36; --panel2:#1c2d5b;
      --gold1:#ffe082; --gold2:#ffca28; --gold3:#ffb300;
      --text:#fff; --muted:#c7d2fe; --shadow:0 18px 32px rgba(0,0,0,.46);
    }
    body {
      margin:0; font-family: Inter,Arial,sans-serif; background:var(--bg); color:var(--text);
    }
    .app { max-width:520px; margin:0 auto; padding:20px; text-align:center; }
    .pill { display:flex; align-items:center; gap:6px; background:rgba(10,15,35,.8);
      border:1px solid rgba(255,255,255,.08); padding:6px 12px; border-radius:999px; }
    .title { font-size:28px; font-weight:900; color:var(--gold2);
      text-shadow:0 0 6px var(--gold3),0 0 14px rgba(255,215,0,.9); margin:20px 0; }
    .upgrade { background:linear-gradient(180deg,var(--panel2),var(--panel));
      padding:16px; border-radius:14px; margin:14px 0; box-shadow:var(--shadow); text-align:left; }
    .upgrade h2 { margin:0 0 10px; font-size:20px; color:var(--gold1); }
    .button { background:linear-gradient(180deg,var(--gold2),var(--gold3)); color:#000;
      padding:8px 14px; border-radius:10px; font-size:15px; font-weight:700;
      cursor:pointer; border:none; }
    .button:disabled { background:gray; cursor:not-allowed; color:#fff; }
    .footer { font-size:14px; color:var(--muted); margin-top:30px; }
    .note { font-size:14px; color:var(--muted); margin-top:20px; }
  </style>
</head>
<body>
  <div class="app">
    <h1 class="title">‚ö° Upgrades</h1>

    <p class="note">Please note: The payment invoices will be sent to the bot's chat for security reasons.</p>

    <div class="upgrade">
      <h2>Multiplier x2</h2>
      <p>Double your coins per tap.</p>
      <button class="button" onclick="sendPaymentRequest(100)">Buy 100 ‚≠ê</button>
    </div>

    <div class="upgrade">
      <h2>Offline Earnings</h2>
      <p>Earn 5% of your coins per hour while offline.</p>
      <button class="button" onclick="sendPaymentRequest(250)">Buy 250 ‚≠ê</button>
    </div>

    <div class="upgrade">
      <h2>+20% Lifetime Bonus</h2>
      <p>Gain +20% coins per tap permanently.</p>
      <button class="button" onclick="sendPaymentRequest(60)">Buy 60 ‚≠ê</button>
    </div>

    <div class="upgrade">
      <h2>Premarket Coins</h2>
      <p>Instant BurgerCoins purchase:</p>
      <button class="button" onclick="sendPaymentRequest(30)">1000 üçî (30 ‚≠ê)</button>
      <button class="button" onclick="sendPaymentRequest(80)">3000 üçî (80 ‚≠ê)</button>
      <button class="button" onclick="sendPaymentRequest(125)">5000 üçî (125 ‚≠ê)</button>
      <button class="button" onclick="sendPaymentRequest(220)">10000 üçî (220 ‚≠ê)</button>
      <button class="button" onclick="sendPaymentRequest(1000)">50000 üçî (1000 ‚≠ê)</button>
    </div>

    <div class="footer">
      <a href="index.html" class="button">‚¨Ö Back to Home</a>
    </div>
  </div>

<script>
// Variabile per memorizzare il chat_id dell'utente
let chatId = null;

// Funzione per avviare la conversazione e ottenere il chat_id
function startConversation() {
  fetch('https://api.telegram.org/bot7564100271:AAEQojBa2USivOFHMLqnWr7BkmE5Iq0o1mY/getUpdates')
    .then(response => response.json())
    .then(data => {
      if (data.result && data.result.length > 0) {
        const lastUpdate = data.result[data.result.length - 1];
        chatId = lastUpdate.message.chat.id; // Estrai il chat_id
        console.log("chat_id: " + chatId);  // Debug: visualizza il chat_id
        // Invia il link alla chat
        sendMessage("Ciao! Puoi usare questo link per iniziare: https://t.me/BurgerrCoinBot?startapp=burgercoin&utm_source=chatgpt.com");
      }
    })
    .catch(error => console.error('Errore durante il recupero del chat_id:', error));
}

// Funzione per inviare un messaggio al chat_id
function sendMessage(message) {
  fetch(`https://api.telegram.org/bot7564100271:AAEQojBa2USivOFHMLqnWr7BkmE5Iq0o1mY/sendMessage`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      chat_id: chatId,
      text: message
    })
  })
  .then(response => response.json())
  .then(data => {
    if (data.ok) {
      console.log("Messaggio inviato con successo!");
    } else {
      console.error("Errore nell'invio del messaggio:", data);
    }
  })
  .catch(error => console.error('Errore nell\'invio del messaggio:', error));
}

// Funzione per inviare la richiesta di pagamento
function sendPaymentRequest(cost) {
  if (chatId === null) {
    alert("Errore: chat_id non trovato! Assicurati di avviare prima la conversazione.");
    return;
  }

  // Converti correttamente il costo in centesimi (1 stella = 1 centesimo di XTR)
  const paymentAmount = cost * 100;  // Adesso il costo corrisponde ai centesimi (1 stella = 1 centesimo)

  fetch('https://api.telegram.org/bot7564100271:AAEQojBa2USivOFHMLqnWr7BkmE5Iq0o1mY/sendInvoice', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      chat_id: chatId,
      title: `Buy ${cost} Stars`,
      description: `Pay ${cost} stars to unlock the upgrade.`,
      payload: 'unique_invoice_payload',  // Personalizza questo campo
      provider_token: '',  // Lasciato vuoto, non necessario per il pagamento in stelle
      start_parameter: 'test-payment',
      currency: 'XTR',  // Valuta in stelle di Telegram (XTR)
      prices: [{ label: `${cost} ‚≠ê`, amount: paymentAmount }]  // Prezzo in centesimi di XTR
    })
  })
  .then(response => response.json())
  .then(data => {
    if (data.ok) {
      console.log("Richiesta di pagamento inviata con successo!");
    } else {
      console.error("Errore nell'invio della richiesta di pagamento", data);
    }
  })
  .catch(error => console.error('Errore nell\'invio della richiesta di pagamento:', error));
}

// Avvia la conversazione per ottenere il chat_id
startConversation();
</script>
</body>
</html>
